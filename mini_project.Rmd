---
title: "Mini-Projet Etude et application de quelques schémas aux différences finies
  pour deux lois de conservation"
author: "AMECK GUY-MAX DESIRE DOSSEH & RIM ELMGHARI"
date: "`r Sys.Date()`"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

On souhaite étudier, appliquer et voir le comportement de quelques schémas aux différences finies
pour deux équations relevant de lois de conservation 1D définies sur un domaine $\Omega = [0, L]$.

# 1. Equation de transport

On considère l'équation de transport soumise à des conditions aux limites periodiques:

$$
(E_{1})\left\{
\begin{array}{ll}
\frac{\partial u}{\partial t} + a\frac{\partial u}{\partial x} = 0, & \forall x \in ]0,L[\  ; \ \forall t>0 \\
u(x, t=0) = u_0(x), & \forall x \in [0,L] \\
u(0, t) = u(L, t)\ ; \ \frac{\partial u}{\partial x}(L, t)=0 & \forall t > 0
\end{array}
\right.
$$
1) A l'aide de la methode des caracteristiques, determiner la solution exacte $u(x, t)$ du probleme $(E_{1})$.

Nous allons chercher une courbe caractéristique $\Gamma ((t(s), x(s))$, s étant le paramètre qui décrit la courbe, le long de laquelle l'EDP devient un système d'EDO.

$$
\begin{aligned}
du &= \frac{\partial u}{\partial t}dt + \frac{\partial u}{\partial x}dx\\
\frac{du}{ds} &= \frac{\partial u}{\partial t}\frac{dt}{ds} + \frac{\partial u}{\partial x}\frac{dx}{ds}\\
\frac{du}{ds} &= -a\frac{\partial u}{\partial x}\frac{dt}{ds} + \frac{\partial u}{\partial x}\frac{dx}{ds}\\
\frac{du}{ds} &= \frac{\partial u}{\partial x}(\frac{dx}{ds}-a\frac{dt}{ds})
\end{aligned}
$$

On voit que si on impose $\frac{dx}{ds}-a\frac{dt}{ds} = 0$, on a $\frac{du}{ds} = 0$, c'est à dire que u est constant le long de la courbe caractéristique. 

On a donc le système d'EDO suivant a resoudre:

$$
\left\{
\begin{array}{ll}
\frac{dx}{dt} = a \ \text{qui donne la courbe caractéristique }\Gamma\\
du = 0 \ \text{qui donne la solution u(x, t) sur cette courbe caractéristique} 
\end{array}
\right.
$$
\newpage

**Courbes caractéristiques:**

$$
\frac{dx}{dt} = a \ \text{donne} \ x(t) = at + \xi (avec \ \xi \ \text{une constante reelle d'integration})
$$

```{python, warning=FALSE, message=FALSE, echo=FALSE}
import numpy as np
import matplotlib.pyplot as plt
import warnings
warnings.filterwarnings("ignore")

# Define the values of a and xi
a = 2
xi_values = [-4, -3, -2, -1, 0, 1, 2, 3, 4]

# Define the time range
t = np.linspace(-10, 10, 100)

plt.figure(figsize=(12, 8))
# Plot the characteristic curves for each xi value
for xi in xi_values:
    x = a * t + xi
    plt.plot(t, x, label=f"xi = {xi}")

# Plot the x and y axes
plt.axhline(0, color='black')
plt.axvline(0, color='black')

plt.xlabel('Time')
plt.ylabel('x(t)')
plt.title('Courbes Caracteristiques')
plt.grid(True)
plt.legend()

# Set the x and y axes limits to center at 0
_ = plt.xlim(-10, 10)
_ = plt.ylim(-10, 10)

# Set the x and y axis ticks
_ = plt.xticks(np.arange(-10, 11, 2))
_ = plt.yticks(np.arange(-10, 11, 2))

# Hide the legend
plt.legend().set_visible(False)
plt.show()
```

**Solution**

Sur chaque courbe caractéristique $(\Gamma): x-at = \xi$, on a:

$$
du = 0 \Rightarrow u(x, t) =  cte = f(\xi) \leftarrow i.e. \text{ u ne depend que de } \xi 
$$
Soit alors 

$$
u(x, t) = f(x-at)
$$
Cette solution doit etre retrouvee aussi pour $t=0$.

Or a $t=0$, on a:

$$
u(x, 0) = u_0(x) = f(x) \Rightarrow f(x) = u_0(x)
$$

c'est a dire $$f\equiv u_0$$

On obtient finalement la solution exacte du probleme $(E_{1})$:

$$
u(x, t) = u_0(x-at), \ \forall x \in [0, L], \ \forall t > 0
$$


On discretise l'intervalle $[0, L]$ en $(N-1)$ sous-interalles $[x_{i}, x_{i+1}](i=1, ..., N-1)$ de tailles egales $\Delta x(\Delta x=\frac{L}{N-1}, x_{i+1}=x_{i}+\Delta x)$, et on note par $u_{i}^{n}$ la solution approchee au noeud $x_{i}$ a l'instant $t^{n}=n\Delta t$($\Delta t$ etant le pas de chnage).


2) Etudier la consistance, la stabilite et la convergence de chacun des schemas numeriques suivants:


**Schema 1 (centre):**

$$
\frac{u_{j}^{n+1}-u_{j}^{n}}{\Delta t} + a\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\Delta x} = 0
$$


- **Consistance**

Utilisons le développement de Taylor pour évaluer la consistance du schéma. On a:

+ D'une part le développement de Taylor de $u_{j}^{n+1}$ à l'ordre 1 :

$$
\begin{aligned}
u_{j}^{n+1} &= u_{j}^{n} + \Delta t\frac{\partial u}{\partial t}|_{j}^{n} + O(\Delta t^2)\\ 
\frac{\partial u}{\partial t}|_{j}^{n} &=\frac{u_{j}^{n+1}-u_{j}^{n}}{\Delta t} + O(\Delta t)
\end{aligned}  
$$



+ Et d’autre part le développement de Taylor de $u_{j+1}^{n}$ et $u_{j-1}^{n}$ à l’ordre 2 :

$$
\begin{aligned}
u_{j+1}^{n} &= u_{j}^{n} + \Delta x\frac{\partial u}{\partial x} + \frac{(\Delta x)^2}{2}\frac{\partial^2 u}{\partial x^2} + O((\Delta x)^3)\\
u_{j-1}^{n} &= u_{j}^{n} - \Delta x\frac{\partial u}{\partial x} + \frac{(\Delta x)^2}{2}\frac{\partial^2 u}{\partial x^2} + O((\Delta x)^3)\\
\frac{\partial u}{\partial x}|_{j}^{n} &=\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\Delta x} + O((\Delta x)^2)\\
\end{aligned} 
$$

On obtient alors le schéma numérique:

$$
\begin{cases}
\frac{u_{j}^{n+1}-u_{j}^{n}}{\Delta t} + a\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\Delta x} = 0 &\ \forall x \in ]0, L[; \forall t>0 \\
u(x, 0) = u_0(x) &\ \forall x \in [0, L]\\
u(0, t) = u(L, t) \ \text{et} \ \frac{\partial u}{\partial x}(L, t)=0 &\ \forall t > 0
\end{cases}
$$

dont l'erreur de troncature est:

$$
\begin{aligned}
\text{ET} &= ( \frac{\partial u}{\partial t} + a\frac{\partial u}{\partial x}) -(\frac{u_{j}^{n+1}-u_{j}^{n}}{\Delta t} + a\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\Delta x})\\
&= \mathcal{O}(\Delta t) + \mathcal{O}((\Delta x)^2)\\
\end{aligned}
$$

Nous avons donc un schema d'ordre 1 en temps et d'ordre 2 en espace. 
Par definition de la consistance, Un schéma est dit consistant si l'erreur de troncature tend vers 0 lorsque $\Delta t$ et $\Delta x$ tendent vers 0. Soit:

$$
\lim_{\Delta t, \Delta x \to 0} \text{ET} = 0
$$

Dans notre cas, on a:

$$
\lim_{\Delta t, \Delta x \to 0} \text{ET} = \mathcal{O}(\Delta t) + \mathcal{O}((\Delta x)^2)
$$

Or 

$$
|\mathcal{O}(\Delta t)| \leq C|\Delta t|  \implies \lim_{\Delta t \to 0} \mathcal{O}(\Delta t) = 0
$$
et

$$
|\mathcal{O}((\Delta x)^2)| \leq C|\Delta x|^2  \implies \lim_{\Delta x \to 0} \mathcal{O}((\Delta x)^2) = 0
$$

D'où:

$$
\lim_{\Delta t, \Delta x \to 0} \text{ET} = 0
$$

Par suite, le schéma 1 centre est consistant.


- **Stabilité**

Pour étudier la stabilité du schéma, on utilise la méthode de Von Neumann. On pose:

$$
u_{j}^{n} = C^{n}e^{i\xi x_{j}}, \text{ avec } x_j = j\Delta x \text{ et } \xi \text{ est le nombre d'onde}
$$
et on injecte cette solution dans le schéma numérique:

$$
\begin{aligned}
\frac{u_{j}^{n+1}-u_{j}^{n}}{\Delta t} + a\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\Delta x} = 0 & \implies \frac{C^{n+1}e^{i\xi x_{j}}-C^{n}e^{i\xi x_{j}}}{\Delta t} + a\frac{C^{n}e^{i\xi x_{j+1}}-C^{n}e^{i\xi x_{j-1}}}{2\Delta x} = 0\\
       & \implies \frac{C^{n+1}e^{i\xi j\Delta x}-C^{n}e^{i\xi j\Delta x}}{\Delta t} + a\frac{C^{n}e^{i\xi (j+1)\Delta x}-C^{n}e^{i\xi (j-1)\Delta x}}{2\Delta x} = 0\\
       & \implies \frac{C^{n+1}-C^{n}}{\Delta t}e^{i\xi j\Delta x} + a\frac{e^{i\xi \Delta x}-e^{-i\xi \Delta x}}{2\Delta x}C^{n}e^{i\xi j\Delta x} = 0\\
       & \implies C^{n+1} = C^{n} - \frac{a\Delta t}{\Delta x}sin(\xi \Delta x)C^{n}\\
       & \implies C^{n+1} = (1 - \frac{a\Delta t}{\Delta x}isin(\xi \Delta x))C^{n}\\
       & \implies C^{n+1} = (1 - i\lambda sin(\xi \Delta x))C^{n}, \text{ avec } \lambda = \frac{a\Delta t}{\Delta x}\\
       & \implies C^{n+1} = (1 - i\lambda sin(\xi \Delta x))^{n}C^{0}
\end{aligned}
$$



On doit avoir $|1 - i\lambda sin(\xi \Delta x)|\leq 1\  \forall \xi \in \mathbb{R}$


On a:

$$
\begin{aligned}
|1 - i\lambda sin(\xi \Delta x)|^2 &\leq 1\\
1+\lambda^2sin^{2}(\xi \Delta x) &\leq 1\\
\lambda^2sin^{2}(\xi \Delta x) &\leq 0 \ (\text{  ce qui est absurde})\\
\end{aligned}
$$

Ainsi, le schéma 1 centre est instable.

- **Convergence**

En utilisant la contraposee du theoreme de Lax, on a:

Le shéma 1 centre n'est pas stable, donc il n'est pas convergent.


**Schema 2 (decentre):**

$$
\begin{aligned}
\frac{u_{j}^{n+1}-u_{j}^{n}}{\Delta t} + a\frac{u_{j}^{n}-u_{j-1}^{n}}{\Delta x} = 0 & \text{ si } a > 0\\
\frac{u_{j}^{n+1}-u_{j}^{n}}{\Delta t} + a\frac{u_{j+1}^{n}-u_{j}^{n}}{\Delta x} = 0 & \text{ si } a < 0
\end{aligned}
$$

- **Cas a > 0**

    - **Consistance**

Utilisons le développement de Taylor pour évaluer la consistance du schéma. On a:

+ D'une part le développement de Taylor de $u_{j}^{n+1}$ à l'ordre 1 :

$$
\begin{aligned}
u_{j}^{n+1} &= u_{j}^{n} + \Delta t\frac{\partial u}{\partial t}|_{j}^{n} + O(\Delta t^2)\\
\frac{\partial u}{\partial t}|_{j}^{n} &=\frac{u_{j}^{n+1}-u_{j}^{n}}{\Delta t} + O(\Delta t)
\end{aligned}
$$
+ Et d’autre part le développement de Taylor de $u_{j}^{n}$ et $u_{j-1}^{n}$ à l’ordre 1 :

$$
\begin{aligned}
u_{j}^{n} &= u_{j}^{n} + \Delta x\frac{\partial u}{\partial x} + O(\Delta x^2)\\
u_{j-1}^{n} &= u_{j}^{n} - \Delta x\frac{\partial u}{\partial x} + O(\Delta x^2)\\
\frac{\partial u}{\partial x}|_{j}^{n} &=\frac{u_{j}^{n}-u_{j-1}^{n}}{\Delta x} + O(\Delta x)
\end{aligned} 
$$


On obtient alors le schéma numérique:

$$
\begin{cases}
\frac{u_{j}^{n+1}-u_{j}^{n}}{\Delta t} + a\frac{u_{j}^{n}-u_{j-1}^{n}}{\Delta x} = 0 &\ \forall x \in ]0, L[; \forall t>0 \\
u(x, 0) = u_0(x) &\ \forall x \in [0, L]\\
u(0, t) = u(L, t) \ \text{et} \ \frac{\partial u}{\partial x}(L, t)=0 &\ \forall t > 0
\end{cases}
$$

dont l'erreur de troncature est:

$$
\begin{aligned}
\text{ET} &= ( \frac{\partial u}{\partial t} + a\frac{\partial u}{\partial x}) -(\frac{u_{j}^{n+1}-u_{j}^{n}}{\Delta t} + a\frac{u_{j}^{n}-u_{j-1}^{n}}{\Delta x})\\
&= \mathcal{O}(\Delta t) + \mathcal{O}(\Delta x)\\
\end{aligned}
$$

Nous avons donc un schema d'ordre 1 en temps et d'ordre 1 en espace.

Par definition de la consistance, Un schéma est dit consistant si l'erreur de troncature tend vers 0 lorsque $\Delta t$ et $\Delta x$ tendent vers 0. Soit:

$$
\lim_{\Delta t, \Delta x \to 0} \text{ET} = 0 
$$

Dans notre cas, on a:

$$
\lim_{\Delta t, \Delta x \to 0} \text{ET} = \mathcal{O}(\Delta t) + \mathcal{O}(\Delta x)
$$

Or

$$
|\mathcal{O}(\Delta t)| \leq C|\Delta t|  \implies \lim_{\Delta t \to 0} \mathcal{O}(\Delta t) = 0 
$$

et

$$
|\mathcal{O}(\Delta x)| \leq C|\Delta x|  \implies \lim_{\Delta x \to 0} \mathcal{O}(\Delta x) = 0 
$$

D'où:

$$
\lim_{\Delta t, \Delta x \to 0} \text{ET} = 0
$$

Par suite, le schéma 2 décentré en amont est consistant.


- **Stabilité**

Pour étudier la stabilité du schéma, on utilise la méthode de Von Neumann. On pose:

$$
u_{j}^{n} = C^{n}e^{i\xi x_{j}}, \text{ avec } x_j = j\Delta x \text{ et } \xi \text{ est le nombre d'onde} 
$$

et on injecte cette solution dans le schéma numérique:

$$
\begin{aligned}
\frac{u_{j}^{n+1}-u_{j}^{n}}{\Delta t} + a\frac{u_{j}^{n}-u_{j-1}^{n}}{\Delta x} = 0 & \implies \frac{C^{n+1}e^{i\xi x_{j}}-C^{n}e^{i\xi x_{j}}}{\Delta t} + a\frac{C^{n}e^{i\xi x_{j}}-C^{n}e^{i\xi x_{j-1}}}{\Delta x} = 0\\
       & \implies \frac{C^{n+1}e^{i\xi j\Delta x}-C^{n}e^{i\xi j\Delta x}}{\Delta t} + a\frac{C^{n}e^{i\xi j\Delta x}-C^{n}e^{i\xi (j-1)\Delta x}}{\Delta x} = 0\\
       & \implies \frac{C^{n+1}-C^{n}}{\Delta t}e^{i\xi j\Delta x} + a\frac{1-e^{-i\xi \Delta x}}{\Delta x}C^{n}e^{i\xi j\Delta x} = 0\\
       & \implies C^{n+1} = C^{n} - \frac{a\Delta t}{\Delta x}(1-e^{-i\xi \Delta x})C^{n}\\
       & \implies C^{n+1} = (1 - \frac{a\Delta t}{\Delta x}(1-e^{-i\xi \Delta x}))C^{n}\\
       & \implies C^{n+1} = (1 - \lambda (1-e^{-i\xi \Delta x}))C^{n}, \text{ avec } \lambda = \frac{a\Delta t}{\Delta x}\\
\end{aligned}
$$

On doit avoir $|1 - \lambda (1-e^{-i\xi \Delta x})|\leq 1\  \forall \xi \in \mathbb{R}$

\newpage

On a:

$$
\begin{aligned}
|1 - \lambda (1-e^{-i\xi \Delta x})|^2 &\leq 1\\
|1 - \lambda(1-(cos(-\xi\Delta x)+isin(-\xi\Delta x)))|^2 &\leq 1\\
|1 - \lambda(1-cos(\xi\Delta x)+isin(\xi\Delta x))|^2 &\leq 1\\
|1 - \lambda+\lambda cos(\xi\Delta x)-i\lambda sin(\xi\Delta x))|^2 &\leq 1\\
(1 - \lambda+\lambda cos(\xi\Delta x))^2+(\lambda sin(\xi\Delta x))^2 &\leq 1\\
1 - 2\lambda+\lambda^2 +\lambda^2cos^2(\xi\Delta x)+2(1-\lambda)\lambda cos(\xi\Delta x)+\lambda^2sin^2(\xi\Delta x) &\leq 1\\
1 - 2\lambda+2\lambda^2 +2(1-\lambda)\lambda cos(\xi\Delta x) &\leq 1\\
2\lambda^2 - 2\lambda+2(1-\lambda)\lambda cos(\xi\Delta x) &\leq 0\\
\lambda^2 - \lambda+(1-\lambda)\lambda cos(\xi\Delta x) &\leq 0\\
\lambda(\lambda-1)-(\lambda-1)\lambda cos(\xi\Delta x) &\leq 0\\
\lambda(\lambda-1)(1- cos(\xi\Delta x)) &\leq 0\\
\end{aligned}
$$

Or $\lambda > 0$ et $1-cos(\xi\Delta x) \geq 0$, on doit donc avoir:

$$
\begin{aligned}
\lambda - 1 &\leq 0\\
\lambda &\leq 1\\
\lambda=\frac{a\Delta t}{\Delta x} &\leq 1
\end{aligned}
$$

Ainsi, le schéma 2 décentré en amont est stable si $\frac{a\Delta t}{\Delta x} \leq 1$.

- **Convergence**

Le schema 2 décentré etant consistant et conditionnellement stable; en utilisant le theorème de Lax sous les memes conditions de stabilité, on deduit que le schema 2 décentré en amont($a>0$) est convergent.

- **Cas a < 0**

    - **Consistance**
    
Utilisons le développement de Taylor pour évaluer la consistance du schéma. On a:

+ D'une part le développement de Taylor de $u_{j}^{n+1}$ à l'ordre 1 :

$$
\begin{aligned}
u_{j}^{n+1} &= u_{j}^{n} + \Delta t\frac{\partial u}{\partial t}|_{j}^{n} + O(\Delta t^2)\\
\frac{\partial u}{\partial t}|_{j}^{n} &=\frac{u_{j}^{n+1}-u_{j}^{n}}{\Delta t} + O(\Delta t)
\end{aligned}
$$

+ Et d’autre part le développement de Taylor de $u_{j+1}^{n}$ et $u_{j}^{n}$ à l’ordre 1 :

$$
\begin{aligned}
u_{j+1}^{n} &= u_{j}^{n} + \Delta x\frac{\partial u}{\partial x} + O(\Delta x^2)\\
u_{j}^{n} &= u_{j}^{n} - \Delta x\frac{\partial u}{\partial x} + O(\Delta x^2)\\
\frac{\partial u}{\partial x}|_{j}^{n} &=\frac{u_{j+1}^{n}-u_{j}^{n}}{\Delta x} + O(\Delta x)
\end{aligned}
$$

On obtient alors le schéma numérique:

$$
\begin{cases}
\frac{u_{j}^{n+1}-u_{j}^{n}}{\Delta t} + a\frac{u_{j+1}^{n}-u_{j}^{n}}{\Delta x} = 0 &\ \forall x \in ]0, L[; \forall t>0 \\
u(x, 0) = u_0(x) &\ \forall x \in [0, L]\\
u(0, t) = u(L, t) \ \text{et} \ \frac{\partial u}{\partial x}(L, t)=0 &\ \forall t > 0
\end{cases}
$$

dont l'erreur de troncature est:

$$
\begin{aligned}
\text{ET} &= ( \frac{\partial u}{\partial t} + a\frac{\partial u}{\partial x}) -(\frac{u_{j}^{n+1}-u_{j}^{n}}{\Delta t} + a\frac{u_{j+1}^{n}-u_{j}^{n}}{\Delta x})\\
&= \mathcal{O}(\Delta t) + \mathcal{O}(\Delta x)\\
\end{aligned}
$$

Nous avons donc un schema d'ordre 1 en temps et d'ordre 1 en espace.

Par definition de la consistance, un schéma est dit consistant si l'erreur de troncature tend vers 0 lorsque $\Delta t$ et $\Delta x$ tendent vers 0. Soit:

$$
\lim_{\Delta t, \Delta x \to 0} \text{ET} = 0
$$


Dans notre cas, on a:

$$
\lim_{\Delta t, \Delta x \to 0} \text{ET} = \mathcal{O}(\Delta t) + \mathcal{O}(\Delta x)
$$

Or

$$
|\mathcal{O}(\Delta t)| \leq C|\Delta t|  \implies \lim_{\Delta t \to 0} \mathcal{O}(\Delta t) = 0
$$

et

$$
|\mathcal{O}(\Delta x)| \leq C|\Delta x|  \implies \lim_{\Delta x \to 0} \mathcal{O}(\Delta x) = 0
$$

D'où:

$$
\lim_{\Delta t, \Delta x \to 0} \text{ET} = 0
$$

Par suite, le schéma 2 décentré en aval est consistant.


- **Stabilité**

    
Pour étudier la stabilité du schéma, on utilise la méthode de Von Neumann. On pose:

$$
u_{j}^{n} = C^{n}e^{i\xi x_{j}}, \text{ avec } x_j = j\Delta x \text{ et } \xi \text{ est le nombre d'onde}
$$

\newpage

et on injecte cette solution dans le schéma numérique:

$$
\begin{aligned}
\frac{u_{j}^{n+1}-u_{j}^{n}}{\Delta t} + a\frac{u_{j+1}^{n}-u_{j}^{n}}{\Delta x} = 0 & \implies \frac{C^{n+1}e^{i\xi x_{j}}-C^{n}e^{i\xi x_{j}}}{\Delta t} + a\frac{C^{n}e^{i\xi x_{j+1}}-C^{n}e^{i\xi x_{j}}}{\Delta x} = 0\\
       & \implies \frac{C^{n+1}e^{i\xi j\Delta x}-C^{n}e^{i\xi j\Delta x}}{\Delta t} + a\frac{C^{n}e^{i\xi (j+1)\Delta x}-C^{n}e^{i\xi j\Delta x}}{\Delta x} = 0\\
       & \implies \frac{C^{n+1}-C^{n}}{\Delta t}e^{i\xi j\Delta x} + a\frac{e^{i\xi \Delta x}-1}{\Delta x}C^{n}e^{i\xi j\Delta x} = 0\\
       & \implies C^{n+1} = C^{n} - \frac{a\Delta t}{\Delta x}(1-e^{i\xi \Delta x})C^{n}\\
       & \implies C^{n+1} = (1 - \lambda(1-e^{i\xi \Delta x}))C^{n}, \text{ avec } \lambda = \frac{a\Delta t}{\Delta x}\\
\end{aligned}
$$

On doit avoir $|1 - \lambda(1-e^{i\xi \Delta x})|\leq 1\  \forall \xi \in \mathbb{R}$


On a:

$$
\begin{aligned}
|1 - \lambda(1-e^{i\xi \Delta x})|^2 &\leq 1\\
|1 - \lambda(1-cos(\xi\Delta x)+isin(\xi\Delta x))|^2 &\leq 1\\
|1 - \lambda+\lambda cos(\xi\Delta x)-i\lambda sin(\xi\Delta x))|^2 &\leq 1\\
(1 - \lambda+\lambda cos(\xi\Delta x))^2+(\lambda sin(\xi\Delta x))^2 &\leq 1\\
1 - 2\lambda+\lambda^2 +\lambda^2cos^2(\xi\Delta x)+2(1-\lambda)\lambda cos(\xi\Delta x)+\lambda^2sin^2(\xi\Delta x) &\leq 1\\
1 - 2\lambda+2\lambda^2 +2(1-\lambda)\lambda cos(\xi\Delta x) &\leq 1\\
2\lambda^2 - 2\lambda+2(1-\lambda)\lambda cos(\xi\Delta x) &\leq 0\\
\lambda^2 - \lambda+(1-\lambda)\lambda cos(\xi\Delta x) &\leq 0\\
\lambda(\lambda-1)-(\lambda-1)\lambda cos(\xi\Delta x) &\leq 0\\
\lambda(\lambda-1)(1- cos(\xi\Delta x)) &\leq 0\\
\end{aligned}
$$


Or $\lambda < 0$ et $1-cos(\xi\Delta x) \geq 0$,  alors, le schéma 2 décentré en aval est inconditionnellement stable.


- **Convergence**
    
Le schema 2 décentré etant consistant et stable; en utilisant le theorème de Lax, on deduit que le schema 2 décentré en aval ($a<0$) est convergent.


**Schema 3 (Lax-Friedrichs):**

$$
\frac{u_{j}^{n+1}-\frac{1}{2}(u_{j-1}^{n}+u_{j+1}^{n})}{\Delta t} + a\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\Delta x} = 0
$$

- **Consistance**

Utilisons le développement de Taylor pour évaluer la consistance du schéma. On a:

+ D'une part le développement de Taylor de $u_{j+1}^{n}$ et $u_{j-1}^{n}$ à l’ordre 2 :

$$
\begin{aligned}
u_{j+1}^{n} &= u_{j}^{n} + \Delta x\frac{\partial u}{\partial x} + \frac{(\Delta x)^2}{2}\frac{\partial^2 u}{\partial x^2} + O((\Delta x)^3)\\
u_{j-1}^{n} &= u_{j}^{n} - \Delta x\frac{\partial u}{\partial x} + \frac{(\Delta x)^2}{2}\frac{\partial^2 u}{\partial x^2} + O((\Delta x)^3)\\
\frac{\partial u}{\partial x}|_{j}^{n} &=\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\Delta x} + O((\Delta x)^2)\\
\end{aligned}
$$



+ D'une part le développement de Taylor de $u_{j}^{n+1}$ à l'ordre 1:

$$
\begin{aligned}
u_{j}^{n+1} &= u_{j}^{n} + \Delta t\frac{\partial u}{\partial t}|_{j}^{n} + O(\Delta t^2)\\
\frac{\partial u}{\partial t}|_{j}^{n} &=\frac{u_{j}^{n+1}-u_{j}^{n}}{\Delta t} + O(\Delta t)
\end{aligned}
$$

En utilisant les deux premiers développement de Taylor tronques a l'ordre 1, on obtient $u_j^n$ comme somme de $u_{j+1}^{n}$ et $u_{j-1}^{n}$:


$$
\begin{aligned}
u_{j}^{n} &= \frac{1}{2}(u_{j-1}^{n}+u_{j+1}^{n}) + O((\Delta x)^2)
\end{aligned}
$$

En remplacant dans le troisieme développement de Taylor, on obtient:

$$
\begin{aligned}
\frac{\partial u}{\partial t}|_{j}^{n} &=\frac{u_{j}^{n+1}-\frac{1}{2}(u_{j-1}^{n}+u_{j+1}^{n})}{\Delta t} + O(\Delta t)\\
\end{aligned}
$$


On obtient alors le schéma numérique:

$$
\begin{cases}
\frac{u_{j}^{n+1}-\frac{1}{2}(u_{j-1}^{n}+u_{j+1}^{n})}{\Delta t} + a\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\Delta x} = 0 &\ \forall x \in ]0, L[; \forall t>0 \\
u(x, 0) = u_0(x) &\ \forall x \in [0, L]\\
u(0, t) = u(L, t) \ \text{et} \ \frac{\partial u}{\partial x}(L, t)=0 &\ \forall t > 0
\end{cases}
$$

dont l'erreur de troncature est:

$$
\begin{aligned}
\text{ET} &= ( \frac{\partial u}{\partial t} + a\frac{\partial u}{\partial x}) -(\frac{u_{j}^{n+1}-\frac{1}{2}(u_{j-1}^{n}+u_{j+1}^{n})}{\Delta t} + a\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\Delta x})\\
&= \mathcal{O}(\Delta t) + \mathcal{O}(\Delta x)^2\\
\end{aligned}
$$

Nous avons donc un schema d'ordre 1 en temps et d'ordre 2 en espace.

Par definition de la consistance, Un schéma est dit consistant si l'erreur de troncature tend vers 0 lorsque $\Delta t$ et $\Delta x$ tendent vers 0. Soit:


$$
\lim_{\Delta t, \Delta x \to 0} \text{ET} = 0
$$


Dans notre cas, on a:

$$
\lim_{\Delta t, \Delta x \to 0} \text{ET} = \mathcal{O}(\Delta t) + \mathcal{O}(\Delta x)^2
$$

Or

$$
|\mathcal{O}(\Delta t)| \leq C|\Delta t|  \implies \lim_{\Delta t \to 0} \mathcal{O}(\Delta t) = 0
$$

et

$$
|\mathcal{O}(\Delta x)^2| \leq C|\Delta x|^2  \implies \lim_{\Delta x \to 0} \mathcal{O}(\Delta x)^2 = 0
$$


D'où:

$$
\lim_{\Delta t, \Delta x \to 0} \text{ET} = 0
$$

Par suite, le schéma 3 Lax-Friedrichs est consistant.


- **Stabilité**

Pour étudier la stabilité du schéma, on utilise la méthode de Von Neumann. On pose:

$$
u_{j}^{n} = C^{n}e^{i\xi x_{j}}, \text{ avec } x_j = j\Delta x \text{ et } \xi \text{ est le nombre d'onde}
$$

et on injecte cette solution dans le schéma numérique:

$$
\begin{aligned}
\frac{u_{j}^{n+1}-\frac{1}{2}(u_{j-1}^{n}+u_{j+1}^{n})}{\Delta t} + a\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\Delta x} = 0 & \implies \frac{C^{n+1}e^{i\xi x_{j}}-\frac{1}{2}(C^{n}e^{i\xi x_{j-1}}+C^{n}e^{i\xi x_{j+1}})}{\Delta t} + a\frac{C^{n}e^{i\xi x_{j+1}}-C^{n}e^{i\xi x_{j-1}}}{2\Delta x} = 0\\
       & \implies \frac{C^{n+1}e^{i\xi j\Delta x}-\frac{1}{2}(C^{n}e^{i\xi (j-1)\Delta x}+C^{n}e^{i\xi (j+1)\Delta x})}{\Delta t} + a\frac{C^{n}e^{i\xi (j+1)\Delta x}-C^{n}e^{i\xi (j-1)\Delta x}}{2\Delta x} = 0\\
       & \implies \frac{C^{n+1}-\frac{1}{2}(C^{n}e^{-i\xi \Delta x}+C^{n}e^{i\xi \Delta x})}{\Delta t} + a\frac{e^{i\xi \Delta x}-e^{-i\xi \Delta x}}{2\Delta x}C^{n} = 0\\
       & \implies C^{n+1} = \frac{1}{2}(C^{n}e^{-i\xi \Delta x}+C^{n}e^{i\xi \Delta x}) - \frac{a\Delta t}{2\Delta x}(e^{i\xi \Delta x}-e^{-i\xi \Delta x})C^{n}\\
       & \implies C^{n+1} = \frac{1}{2}(C^{n}(cos(\xi \Delta x)-isin(\xi \Delta x)+cos(\xi \Delta x)+isin(\xi \Delta x)) - \frac{a\Delta t}{2\Delta x}(cos(\xi \Delta x)+isin(\xi \Delta x)-cos(\xi \Delta x)+isin(\xi \Delta x))C^{n}\\
       & \implies C^{n+1} = \frac{1}{2}(2cos(\xi\Delta x)-\frac{a\Delta t}{2\Delta x}2isin(\xi\Delta x))C^{n}\\
       & \implies C^{n+1} = (cos(\xi\Delta x)-i\lambda sin(\xi\Delta x))C^{n}, \text{ avec } \lambda = \frac{a\Delta t}{\Delta x}\\
\end{aligned}
$$

On doit avoir $|cos(\xi\Delta x)-i\lambda sin(\xi\Delta x)|\leq 1\  \forall \xi \in \mathbb{R}$

On a:

$$
\begin{aligned}
|cos(\xi\Delta x)-i\lambda sin(\xi\Delta x)|^2 &\leq 1\\
(cos(\xi\Delta x))^2+(\lambda sin(\xi\Delta x))^2 &\leq 1\\
cos^2(\xi\Delta x)+\lambda^2sin^2(\xi\Delta x) &\leq 1\\
1- sin^2(\xi\Delta x)+\lambda^2sin^2(\xi\Delta x) &\leq 1\\
1-(1-\lambda^2)sin^2(\xi\Delta x) &\leq 1\\
-(1-\lambda^2)sin^2(\xi\Delta x) &\leq 0\\
1-\lambda^2 &\geq 0\\
\lambda^2 &\leq 1\\
\lambda=\frac{a\Delta t}{\Delta x} &\leq 1
\end{aligned}
$$

Ainsi, le schéma 3 Lax-Friedrichs est stable si $\frac{a\Delta t}{\Delta x} \leq 1$(**condition de  Courant-Friedrichs-Lewy**).

- **Convergence**

Le schema 3 Lax-Friedrichs etant consistant et conditionnellement stable; en utilisant le theorème de Lax, on deduit que le schema 3 Lax-Friedrichs est convergent.


**Schema 4 (Lax-Wendroff):**

$$
\frac{u_{j}^{n+1}-u_{j}^{n}}{\Delta t} + a\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\Delta x} - \frac{a^{2}\Delta t}{2(\Delta x)^{2}}(u_{j-1}^{n}-2u_{j}^{n}+u_{j+1}^{n}) = 0
$$


- **Consistance**

Utilisons le développement de Taylor pour évaluer la consistance du schéma. On a:


3) Implémenter chacun des schémas numériques pour évaluer la solution approchée, puis comparer cette solution avec la solution exacte. (Tracer les solutions aux temps physiques t1 = 2.5 s et t2 = 4.5 s en testant sur deux maillages différents formés de N = 100 et N = 200 points. Interpréter les résultats.


4) Evaluer l’erreur en norme $L^1$ de la solution numérique obtenue par chaque schéma au temps $t_1 = 2.5 s$ et pour N = 100. Interpréter.

**Données** :

$L = 10 m ,\  a = 2 m/s , \ u_0(x) = 1\  pour\  3 m \leq x \leq 4 m\  et\  0 \ ailleurs.$

Nombre de Courant : $CFL = 0.8$.


# 2. Equation de Burgers

On considere maintenant l'equation de Burgers suivante:

$$
(E_{2})\left\{
\begin{array}{ll}
\frac{\partial u}{\partial t} + u\frac{\partial u}{\partial x} = 0, & \forall x \in ]0,L[\  ; \ \forall t>0 \\
u(x, t=0) = u_0(x), & \forall x \in [0,L] \\
\frac{\partial u}{\partial x}(0, t)= \frac{\partial u}{\partial x}(L, t)=0 & \forall t > 0
\end{array}
\right.
$$
5) Reprendre les questions 1), 3) et 4).

**Données** :

$L = 6m ,\  u_0(x) = 0.4\  pour\  x < 2m \ et \ 0.1\ ailleurs.\ CFL = 0.8$.





