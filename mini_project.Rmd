---
title: "Mini-Projet Etude et application de quelques schémas aux différences finies
  pour deux lois de conservation"
author: "AMECK GUY-MAX DESIRE DOSSEH & RIM ELMGHARI"
date: "`r Sys.Date()`"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

On souhaite étudier, appliquer et voir le comportement de quelques schémas aux différences finies
pour deux équations relevant de lois de conservation 1D définies sur un domaine $\Omega = [0, L]$.

# 1. Equation de transport

On considère l'équation de transport soumise à des conditions aux limites periodiques:

$$
(E_{1})\left\{
\begin{array}{ll}
\frac{\partial u}{\partial t} + a\frac{\partial u}{\partial x} = 0, & \forall x \in ]0,L[\  ; \ \forall t>0 \\
u(x, t=0) = u_0(x), & \forall x \in [0,L] \\
u(0, t) = u(L, t)\ ; \ \frac{\partial u}{\partial x}(L, t)=0 & \forall t > 0
\end{array}
\right.
$$
1) A l'aide de la methode des caracteristiques, determiner la solution exacte $u(x, t)$ du probleme $(E_{1})$.

Nous allons chercher une courbe caractéristique $\Gamma ((t(s), x(s))$, s étant le paramètre qui décrit la courbe, le long de laquelle l'EDP devient un système d'EDO.

$$
\begin{aligned}
du &= \frac{\partial u}{\partial t}dt + \frac{\partial u}{\partial x}dx\\
\frac{du}{ds} &= \frac{\partial u}{\partial t}\frac{dt}{ds} + \frac{\partial u}{\partial x}\frac{dx}{ds}\\
\frac{du}{ds} &= -a\frac{\partial u}{\partial x}\frac{dt}{ds} + \frac{\partial u}{\partial x}\frac{dx}{ds}\\
\frac{du}{ds} &= \frac{\partial u}{\partial x}(\frac{dx}{ds}-a\frac{dt}{ds})
\end{aligned}
$$

On voit que si on impose $\frac{dx}{ds}-a\frac{dt}{ds} = 0$, on a $\frac{du}{ds} = 0$, c'est à dire que u est constant le long de la courbe caractéristique. 

On a donc le système d'EDO suivant a resoudre:

$$
\left\{
\begin{array}{ll}
\frac{dx}{dt} = a \ \text{qui donne la courbe caractéristique }\Gamma\\
du = 0 \ \text{qui donne la solution u(x, t) sur cette courbe caractéristique} 
\end{array}
\right.
$$
<b><u>Courbes caractéristiques:</u></b>

$$
\frac{dx}{dt} = a \ \text{donne} \ x(t) = at + \xi (avec \ \xi \ \text{une constante reelle d'integration})
$$

```{python, warning=FALSE, message=FALSE, echo=FALSE}
import numpy as np
import matplotlib.pyplot as plt
import warnings
warnings.filterwarnings("ignore")

# Define the values of a and xi
a = 2
xi_values = [-4, -3, -2, -1, 0, 1, 2, 3, 4]

# Define the time range
t = np.linspace(-10, 10, 100)

# Plot the characteristic curves for each xi value
for xi in xi_values:
    x = a * t + xi
    plt.plot(t, x, label=f"xi = {xi}")

# Plot the x and y axes
plt.axhline(0, color='black')
plt.axvline(0, color='black')

plt.xlabel('Time')
plt.ylabel('x(t)')
plt.title('Courbes Caracteristiques')
plt.grid(True)
plt.legend()

# Set the x and y axes limits to center at 0
_ = plt.xlim(-10, 10)
_ = plt.ylim(-10, 10)

# Set the x and y axis ticks
_ = plt.xticks(np.arange(-10, 11, 2))
_ = plt.yticks(np.arange(-10, 11, 2))

# Hide the legend
plt.legend().set_visible(False)
plt.show()
```











On discretise l'intervalle $[0, L]$ en $(N-1)$ sous-interalles $[x_{i}, x_{i+1}](i=1, ..., N-1)$ de tailles egales $\Delta x(\Delta x=\frac{L}{N-1}, x_{i+1}=x_{i}+\Delta x)$, et on note par $u_{i}^{n}$ la solution approchee au noeud $x_{i}$ a l'instant $t^{n}=n\Delta t$($\Delta t$ etant le pas de chnage).


2) Etudier la consistance, la stabilite et la convergence de chacun des schemas numeriques suivants:

<u>Schema 1 (centre):</u>

$$
\frac{u_{j}^{n+1}-u_{j}^{n}}{\Delta t} + a\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\Delta x} = 0
$$

<u>Schema 2 (decentre):</u>

$$
\begin{aligned}
\frac{u_{j}^{n+1}-u_{j}^{n}}{\Delta t} + a\frac{u_{j}^{n}-u_{j-1}^{n}}{\Delta x} = 0 & \text{ si } a > 0\\
\frac{u_{j}^{n+1}-u_{j}^{n}}{\Delta t} + a\frac{u_{j+1}^{n}-u_{j}^{n}}{\Delta x} = 0 & \text{ si } a < 0
\end{aligned}
$$

<u>Schema 3 (Lax-Friedrichs):</u>

$$
\frac{u_{j}^{n+1}-\frac{1}{2}(u_{j-1}^{n}+u_{j+1}^{n})}{\Delta t} + a\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\Delta x} = 0
$$


<u>Schema 4 (Lax-Wendroff):</u>

$$
\frac{u_{j}^{n+1}-u_{j}^{n}}{\Delta t} + a\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\Delta x} - \frac{a^{2}\Delta t}{2(\Delta x)^{2}}(u_{j-1}^{n}-2u_{j}^{n}+u_{j+1}^{n}) = 0
$$


3) Implémenter chacun des schémas numériques pour évaluer la solution approchée, puis comparer cette solution avec la solution exacte. (Tracer les solutions aux temps physiques t1 = 2.5 s et t2 = 4.5 s en testant sur deux maillages différents formés de N = 100 et N = 200 points. Interpréter les résultats.


4) Evaluer l’erreur en norme $L^1$ de la solution numérique obtenue par chaque schéma au temps $t_1 = 2.5 s$ et pour N = 100. Interpréter.

**Données** :

$L = 10 m ,\  a = 2 m/s , \ u_0(x) = 1\  pour\  3 m \leq x \leq 4 m\  et\  0 \ ailleurs.$

Nombre de Courant : $CFL = 0.8$.


# 2. Equation de Burgers

On considere maintenant l'equation de Burgers suivante:

$$
(E_{2})\left\{
\begin{array}{ll}
\frac{\partial u}{\partial t} + u\frac{\partial u}{\partial x} = 0, & \forall x \in ]0,L[\  ; \ \forall t>0 \\
u(x, t=0) = u_0(x), & \forall x \in [0,L] \\
\frac{\partial u}{\partial x}(0, t)= \frac{\partial u}{\partial x}(L, t)=0 & \forall t > 0
\end{array}
\right.
$$
5) Reprendre les questions 1), 3) et 4).

**Données** :

$L = 6m ,\  u_0(x) = 0.4\  pour\  x < 2m \ et \ 0.1\ ailleurs.\ CFL = 0.8$.





